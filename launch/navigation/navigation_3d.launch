<launch>
  <!-- Settings -->
  <arg name="namespace" default="pioneer" />
  <!-- Map name -->
  <arg name="map" default="level1" />
  <!-- Initial orientation for AMCL node. (Should be set to match robot spawn position) -->
  <arg name="init_x" default="0.0" />
  <arg name="init_y" default="0.0" />
  <arg name="init_yaw" default="0.0" />
  <!-- Radians -->
  <!-- Move_base configuration folder. -->
  <arg name="move_base_config" default="3d" />
  <!-- NOTE: move_base_config specifies the folder to find the .yaml config files for
       move_base. If you would like to safely play around with navigation settings,
       you can copy the default folder, rename it, then change move_base_config. -->

  <!-- Laser scan sensor is present-->
  <arg name="has_laser" default="false" />

  <arg name="use_static_map" default="false" />

  <!-- Robot sensor topic Mapping-->
  <arg name="laser_topic" />
  <arg name="pointcloud_topic" />

  <!-- use static map -->
  <group if="$(arg use_static_map)">
    <!-- Launch Map Server -->
    <include file="$(find uml_3d_race)/launch/navigation/map_server.launch">
      <arg name="map_name" value="$(arg map)" />
    </include>

    <!-- Launch positive and negative Octomap Server -->
    <include file="$(find uml_3d_race)/launch/navigation/octomap_server.launch">
      <arg name="robot" value="$(arg namespace)" />
      <arg name="map" value="$(arg map)" />
    </include>

    <!--- Launch AMCL (Laser Localization) -->
    <group if="$(arg has_laser)">
      <include file="$(find uml_3d_race)/launch/navigation/amcl.launch">
        <arg name="namespace" value="$(arg namespace)" />
        <arg name="init_x" value="$(arg init_x)" />
        <arg name="init_y" value="$(arg init_y)" />
        <arg name="init_yaw" value="$(arg init_yaw)" />
        <arg name="scan_topic" value="$(arg laser_topic)" />
      </include>
    </group>

    <group unless="$(arg has_laser)">
      <include file="$(find uml_3d_race)/launch/navigation/amcl.launch">
        <arg name="namespace" value="$(arg namespace)" />
        <arg name="init_x" default="$(arg init_x)" />
        <arg name="init_y" default="$(arg init_y)" />
        <arg name="init_yaw" default="$(arg init_yaw)" />
        <arg name="scan_topic" value="kinect_scan" />
      </include>
    </group>
  </group>

  <!-- dont use static map -->
  <group unless="$(arg use_static_map)">

    <!-- Include gmapper -->
    <include file="$(find uml_3d_race)/launch/navigation/gmapper.launch">
      <arg name="namespace" value="$(arg namespace)" />
      <arg name="scan_topic" value="$(arg laser_topic)" />
    </include>

  </group>

  <!-- Launch move_base -->
  <!-- Note that you will also need to change the relevant .yaml files (or make new copies)
       if you wish to use another namespace/robot_name. -->
  <include file="$(find uml_3d_race)/launch/navigation/move_base.launch" if="$(arg use_static_map)">
    <arg name="namespace" value="$(arg namespace)" />
    <arg name="config" value="$(arg move_base_config)" />
  </include>

  <include file="$(find uml_3d_race)/launch/navigation/move_base.launch" unless="$(arg use_static_map)">
    <arg name="namespace" value="$(arg namespace)" />
    <arg name="config" value="$(arg move_base_config)_unknown" />
  </include>

</launch>
